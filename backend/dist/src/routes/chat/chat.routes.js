import jsonContent from "@/openapi/helpers/json-content";
import jsonContentRequired from "@/openapi/helpers/json-content-required";
import * as HttpStatusCodes from "@/config/http-status-codes";
import { createRoute, z } from "@hono/zod-openapi";
import { UserIntentSchema } from "@app/shared";
const tags = ["Chat"];
const messageSchema = z.object({
    role: z.enum(["system", "user", "assistant", "tool"]),
    content: z.any(),
});
export const chat = createRoute({
    tags,
    method: "post",
    path: "/",
    request: {
        body: jsonContentRequired(z.object({
            messages: z.array(messageSchema),
        }), "The chat messages to send to the data assistant"),
    },
    responses: {
        [HttpStatusCodes.OK]: jsonContent(z.object({
            messages: z.array(messageSchema),
            data: z.array(z.record(z.string(), z.any())).optional(),
        }), "The result of the data query generated by the assistant"),
    },
});
export const intent = createRoute({
    tags,
    method: "post",
    path: "/intent",
    request: {
        body: jsonContentRequired(z.object({ messages: z.array(messageSchema) }), "The chat messages to send to the data assistant"),
    },
    responses: {
        [HttpStatusCodes.OK]: jsonContent(z.object({
            messages: z.array(messageSchema),
            data: UserIntentSchema,
        }), "The intent of the chat messages"),
    },
});
